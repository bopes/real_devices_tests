/* eslint import/no-extraneous-dependencies: 0, no-undef: 0, no-unused-expressions: 0 */

const expect = require("chai").expect;
const groupAndCount = require("../src/group-and-count");

describe("groupAndCount", () => {
  it("should group and count nothing", () => {
    expect(groupAndCount([], (i) => i.name)).to.eql({});
  });

  it("should group and count one thing", () => {
    const data = [
      { name: "foo" }
    ];
    expect(groupAndCount(data, (i) => i.name)).to.eql({ foo: 1 });
  });

  it("should support preloading", () => {
    const data = [
      { name: "foo" }
    ];
    expect(groupAndCount(data, (i) => i.name, undefined, ["bar"])).to.eql({ bar: 0, foo: 1 });
  });

  it("should group and count a couple of things", () => {
    const data = [
      { name: "foo" },
      { name: "bar" },
      { name: "foo" },
      { name: "baz" }
    ];
    expect(groupAndCount(data, (i) => i.name)).to.eql({ foo: 2, bar: 1, baz: 1 });
  });

  it("should group and count with an optional counter", () => {
    const data = [
      { name: "foo", count: 2 },
      { name: "bar", count: 20 },
      { name: "foo", count: 5 },
      { name: "baz", count: 6 }
    ];
    expect(groupAndCount(data, (i) => i.name, (i) => i.count)).to.eql({
      foo: 7, bar: 20, baz: 6
    });
  });
});
